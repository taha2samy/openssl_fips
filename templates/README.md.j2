<!--
  Template Version: 1.1.0
  Generated by: Jinja2
  Project: {{ project_name }}
  Author: {{ owner }}
-->

<div align="center">


# üõ°Ô∏è {{ project_name }}

**Hardened, FIPS 140-3 Compliant OpenSSL Images based on Wolfi OS**

[![OpenSSL Version](https://img.shields.io/badge/OpenSSL-{{ core_version }}-blue?logo=openssl&style=flat-square)](https://www.openssl.org/)
[![FIPS Provider](https://img.shields.io/badge/FIPS_Provider-{{ fips_version }}-green?logo=security&style=flat-square)](https://csrc.nist.gov/projects/cryptographic-module-validation-program)
[![Base Image](https://img.shields.io/badge/Base_OS-Wolfi-black?logo=linux&style=flat-square)](https://github.com/wolfi-dev)
[![SLSA Level 3](https://img.shields.io/badge/SLSA-Level_3-purple?logo=slsa&style=flat-square)](https://slsa.dev/)
[![SBOM](https://img.shields.io/badge/SBOM-CycloneDX-orange?logo=cyclonedx&style=flat-square)](https://cyclonedx.org/)
[![Container Registry](https://img.shields.io/badge/Registry-GHCR-blue?logo=github&style=flat-square)]({{ repo_url }})

[Report Bug]({{ repo_url }}/issues) ‚Ä¢ [Request Feature]({{ repo_url }}/issues) ‚Ä¢ [Releases]({{ repo_url }}/releases)

</div>

---

## üìñ Overview

This repository provides production-ready, **Hardened OpenSSL {{ core_version }}** container images with the **FIPS Provider ({{ fips_version }})** enabled by default.

Built on **Wolfi OS** (undistro), these images are designed for high-security environments requiring strict compliance (FedRAMP, HIPAA, PCI-DSS) and a minimal attack surface. The entire build pipeline is secured via GitHub Actions, producing **SLSA Level 3 Provenance** and **SBOMs** for every tag.

### ‚ú® Key Features

*   üîê **FIPS 140-3 Default**: OpenSSL is configured to force FIPS mode out-of-the-box.
*   üê∫ **Wolfi OS Base**: Zero-known vulnerabilities, glibc-free (uses apk/chainguard base).
*   üì¶ **Immutable Infrastructure**: Distroless variant available for production.
*   üìù **Full Supply Chain Security**: Signed images, SBOMs, and Provenance attestations.

---

## üê≥ Image Variants

We provide two flavors of the image to suit different stages of development and deployment.

| Feature             | **Standard Image**                 | **Distroless Image**                          |
| :------------------ | :--------------------------------- | :-------------------------------------------- |
| **Tags**            | `latest`, `{{ core_version }}`     | `distroless`, `{{ core_version }}-distroless` |
| **Base**            | Wolfi OS Base                      | Chainguard Static                             |
| **Shell**           | ‚úÖ Included (`bash`)                | ‚ùå None                                        |
| **Package Manager** | ‚úÖ Included (`apk`)                 | ‚ùå None                                        |
| **Root User**       | ‚ùå (Runs as `openssl`)              | ‚ùå (Runs as `openssl`)                         |
| **Use Case**        | Development, Debugging, CI/CD Jobs | **Production**, Final Deployment              |
| **Size (Approx)**   | ~25 MB                             | ~12 MB                                        |

---

## üöÄ Usage

### 1. Interactive (Standard Image)

Ideal for testing commands or debugging SSL connections.

```bash
docker run --rm -it {{ registry }}/{{ owner }}/{{ repo_name }}:latest
```

### 2. Production Deployment (Distroless)

The distroless image contains *only* the OpenSSL binary and its dependencies (FIPS module). It has no shell, making it extremely secure.

```bash
docker run --rm {{ registry }}/{{ owner }}/{{ repo_name }}:distroless version -a
```

### 3. Using as a Base in Dockerfile

You can copy the FIPS-enabled OpenSSL artifacts to your own application image:

```dockerfile
FROM {{ registry }}/{{ owner }}/{{ repo_name }}:latest AS fips-source

FROM ubuntu:22.04
# Copy FIPS module and Config
COPY --from=fips-source /usr/local/ssl /usr/local/ssl
COPY --from=fips-source /usr/local/lib/ossl-modules/fips.so /usr/local/lib/ossl-modules/fips.so
# ... configure your app to use this path
```

---

## ‚úÖ Verifying FIPS Mode

You can verify that the container is running in strict FIPS mode by checking the loaded providers or attempting to use a weak algorithm (which should fail).

### Check Loaded Providers

```bash
docker run --rm {{ registry }}/{{ owner }}/{{ repo_name }}:latest list -providers
```

**Expected Output:**

```text
Providers:
  default
  base
  fips    <--- MUST be present
```

### Check Weak Algorithm Block (MD5)

FIPS mode disables MD5 for signatures. This command **MUST FAIL** to prove FIPS is working.

```bash
docker run --rm {{ registry }}/{{ owner }}/{{ repo_name }}:latest dgst -md5 /etc/ssl/certs/ca-certificates.crt
```

**Expected Output:**

```text
Error setting digest
... digital envelope routines::unsupported ...
```

---

## üîê Supply Chain Security (Cosign & SLSA)

All images are signed and attested using **Sigstore/Cosign** in a GitHub Actions environment. You can verify the integrity and origin of the image before using it.

### Prerequisites

Install [Cosign](https://docs.sigstore.dev/cosign/installation/).

### 1. Verify Image Signature

Confirm the image was signed by the OIDC identity of this repository's CI workflow.

```bash
cosign verify \
  --certificate-identity-regexp "https://github.com/{{ owner }}/.*" \
  --certificate-oidc-issuer "https://token.actions.githubusercontent.com" \
  {{ registry }}/{{ owner }}/{{ repo_name }}:latest
```

### 2. Verify SLSA Provenance (Level 3)

Check *how* the image was built and ensure it hasn't been tampered with.

```bash
cosign verify-attestation \
  --type slsaprovenance \
  --certificate-identity-regexp "https://github.com/{{ owner }}/.*" \
  --certificate-oidc-issuer "https://token.actions.githubusercontent.com" \
  {{ registry }}/{{ owner }}/{{ repo_name }}:latest
```

### 3. Download SBOM (Software Bill of Materials)

Extract the CycloneDX JSON SBOM attached to the image to see all installed packages.

```bash
# Download using Cosign
cosign download attestation \
  --type cyclonedx \
  --predicate-type=https://cyclonedx.org/bom \
  {{ registry }}/{{ owner }}/{{ repo_name }}:latest | jq '.payload | @base64d | fromjson' > sbom.json

# OR using Docker Buildx
docker buildx imagetools inspect {{ registry }}/{{ owner }}/{{ repo_name }}:latest \
  --format '@{{ "{{" }} json .SBOM {{ "}}" }}'
```

---

## üìÇ File Layout

If you need to mount volumes or debug, here are the critical paths inside the container:

| Path                                  | Description                                       |
| :------------------------------------ | :------------------------------------------------ |
| `/usr/local/bin/openssl`              | The FIPS-enabled binary                           |
| `/usr/local/ssl/openssl.cnf`          | Main Configuration File (includes fipsmodule.cnf) |
| `/usr/local/ssl/fipsmodule.cnf`       | FIPS Module Configuration (Checksums)             |
| `/usr/local/lib/ossl-modules/fips.so` | The Compiled FIPS Provider Shared Object          |
| `/etc/ssl/certs/ca-certificates.crt`  | Root CA Certificates (Wolfi)                      |

---

<div align="center">
    <p>
        <small>Generated automatically on {{ generation_date }}</small><br>
        Maintained by <a href="https://github.com/{{ owner }}">{{ owner }}</a>
    </p>
</div>

